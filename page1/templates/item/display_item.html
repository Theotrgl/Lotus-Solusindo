{% extends 'base.html' %}

<html>
  <head>

<head>
    {% block title %}Item Data Table{% endblock %}
  </head>
  <body>
</head>

<body>
    {% block content %}
    <h1>Item List</h1>
    <table
      id="itemTable"
      class="table table-bordered table-striped w-100 table-responsive-lg"
    >
      <thead class="thead-light">
        <tr>
          <th>SKU</th>
          <th>Nama</th>
          <th>Category</th>
          <th>Quantity</th>
          <th>Satuan</th>
          <th>Price</th>
          <th>Tanggal Input</th>
          <th>Gambar</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for i in entities %}
        <tr
          {% if i.is_approved%}
          style="background-color: #ccffc7;"
          {% endif %}
        >
        <td>{{ i.SKU }}</td>
        <td>{{ i.nama }}</td>
        <td>{{ i.category.name }}</td>
        <td>{{ i.quantity }}</td>
        <td>{{ i.unit }}</td>
        <td>{{ i.price }}</td>
        <td>{{ i.Tanggal }}</td>
        <td><img src="{{ i.gambar.url }}" alt="{{ i.nama }}" /></td>
          <td>
            <a href="{% url 'item_detail' i.SKU %}">View</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <script>
      new DataTable("#itemTable",{
        columnDefs: [ {
                  targets: 5, // Target the first column (adjust the index as needed)
                  render: function ( data, type, row ) {
                      if (type === 'display') {
                          if (data.startsWith('IDR')) {
                              // Replace commas with periods and periods with commas
                              data = data.replace(/,/g, '#').replace(/\./g, ',').replace(/#/g, '.');
                              data = data.substr(0, 3) + ' ' + data.substr(3);
                              return data
                          }else if(data.startsWith('$')){
                            data = data.replace('$', 'USD');
                            data = data.substr(0, 3) + ' ' + data.substr(3);
                            return data
                          } else {
                              // Add a space after the first three characters
                              return data.substr(0, 3) + ' ' + data.substr(3);
                          }
                      }
                      return data;
                  }
              } ]
      });
    </script>
    <a href="/add_item">Add Item</a><br/>
    {% endblock %}
</body>

</html>